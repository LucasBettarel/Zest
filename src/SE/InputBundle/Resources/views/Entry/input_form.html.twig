{% extends "SEInputBundle:Entry:input.html.twig" %}

{% macro entryCollection(entry) %}
  <tr>
    <td>#</td>
    <td class="table-size">
      <div class="float-left">
        {{ form_widget(entry.employee, {'attr': {'class': 'form-control'}}) }}
        <p>SESA000000</p>
      </div>
      <div id="presence">
        {{ form_widget(entry.presence.present, {'attr': {'id': 'present'}}) }}
        {{ form_widget(entry.presence.absenceReason, {'attr': {'class': 'form-control hide txtarea-sm'}}) }}
      </div>
    </td>
    <td id="activities">
      <div 
        id="activities-prototype"
        data-prototype="{{ _self.activityCollection(entry.activity_hours.vars.prototype) | e }}">
          {% for activity in entry.activity_hours %}
            {{ _self.activityCollection(activity) }}
          {% endfor %}
      </div>
    </td>
    <td class="table-size">
      <a href=# id="comment" class="btn btn-primary">
        <i class="glyphicon glyphicon-comment"></i>
      </a>
      <a href=# id="rmv" class="btn btn-danger" data-target="entries-prototype">
        <i class="glyphicon glyphicon-trash"></i>
      </a>
      <a href=# id="info" class="btn btn-info">
        <i class="glyphicon glyphicon-info-sign"></i>
      </a>
      <a href=# id="add" class="btn btn-success" data-target="activities-prototype">
        <i class="glyphicon glyphicon-plus"></i>
      </a>
      <div class="hide txtarea-sm">
        {{ form_widget(entry.comments, {'attr': {'class': 'form-control'}}) }}
      </div>  
    </td>
    {{ form_widget(entry) }}
  </tr>
{% endmacro %}

{% macro activityCollection(activity) %}
  <div class="row">
    <div class="col-md-3">{{ form_widget(activity.activity, {'attr': {'class': 'form-control'}}) }} </div>
    <div class="col-md-4">
      <div class="float-left col-xs-6">
        {{ form_widget(activity.regularHours, {'attr': {'class': 'form-control'}}) }}
      </div>
      <div class="input-group float-left col-xs-6" 
           data-toggle="popover" 
           data-trigger="click" 
           title="OT Hours" 
           data-content="lalala">
        {{ form_widget(activity.otHours, {'attr': {'class': 'form-control'}}) }}
        <span class="input-group-addon">
          <span id="overtime" class="glyphicon glyphicon-time">
          </span>
        </span>
      </div>
      <div class='hide ghost float-left'>
          {{ form_widget(activity.otStartTime, {'attr': {'class': 'form-control'}}) }}
          {{ form_widget(activity.otEndTime, {'attr': {'class': 'form-control'}}) }}
      </div>
    </div>
    <div class="float-left">
      <input class="transfer" type="checkbox" value="0" checked="unchecked">
    </div>
    <div class="float-left">
      {{ form_widget(activity.zone, {'attr': {'class': 'form-control'}}) }}
    </div>
    <div>
      <a href=# id="rmv" class="btn btn-danger" data-target="activities-prototype">
        <i class="glyphicon glyphicon-trash"></i>
      </a>
    </div>   
    {{ form_widget(activity) }}
  </div>
  {% endmacro %}

 {% block seinput_form %}

  <div class="well">
   {{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}

    {{ form_errors(form) }}

     <div class="form-group">
        {{ form_label(form.user, "User", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
        {{ form_errors(form.user) }}
        <div class="col-sm-4">
          {{ form_widget(form.user, {'attr': {'class': 'form-control'}}) }}
        </div>
    </div>
    
    <div class="form-group">
     
     <div class="table-responsive">
        <table class="table table-hover table-striped">
          <thead>
            <tr>
              <th>#</th>
              <th class="table-size">Employee</th>
              <th>
                <div class="col-md-2">Activity</div>
                <div class="col-md-5" >Hours</div>
                <div class="col-md-2">Transfer Out</div>
                <div class="col-md-2">Workstation</div>
                <div class="col-md-1"></div>
              </th>
              <th class="table-size">Comments</th>
            </tr>
          </thead>
          <tbody id="entries">
            <div 
            id="entries-prototype"
            data-prototype="{{ _self.entryCollection(form.input_entries.vars.prototype)|e }}">
              {% for entry in form.input_entries %}
                {{ _self.entryCollection(entry) }}
              {% endfor %}
            </div>
          </tbody>
        </table>
      </div>
      <p>
        <a href=# id="add" class="btn btn-success" data-target="entries-prototype">
          <i class="glyphicon glyphicon-plus"></i>
        </a>
      </p> 
    </div>
 
    <div class="form-group">
      {{ form_widget(form.save, {'attr': {'class': 'btn btn-success'}}) }}
    </div>
    
    {{ form_rest(form) }}
    {{ form_end(form) }}
  </div>

  <a tabindex="0" class="btn btn-lg btn-danger" role="button" data-toggle="popover" data-trigger="focus" title="Dismissible popover" data-content="And here's some amazing content. It's very engaging. Right?">Dismissible popover</a>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
{% javascripts '@SEInputBundle/Resources/public/js/*' %}
    <script type="text/javascript" src="{{ asset_url }}"></script>
{% endjavascripts %}

{% endblock %}